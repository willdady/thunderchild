{% extends "thunderchild/base.html" %}

{% block title %}Templates{% endblock %}
{% block title_bar_title %}Templates{% endblock %}


{% block action_bar %}
<a id="create-templategroup-button" href="#" class="btn btn-primary">Create Template Group</a>
<ul class="pull-right">
	<li>
		<a id="delete-template-button" href="#" class="btn btn-danger">Delete Template</a>
	</li>
	<li>
		<a id="save-template-button" href="#" class="btn btn-primary">Save Template</a>
	</li>
</ul>
{% endblock %}


{% block content %}
		
		
	<div id="template-browser">
		<ul>
			{% for t in templates %}
			<li data-id="{{ t.templategroup.id }}">
				<div class="group-header clearfix" data-toggle="collapse" data-target="#template-group-{{ t.templategroup.id }}">
					<h3>{{ t.templategroup.templategroup_short_name }}</h3>
					<a href="#" class="new-template-button"><i class="icon-plus icon-white pull-right"></i></a>
				</div>
				<ul id="template-group-{{ t.templategroup.id }}" class="collapse in">
				{% for template in t.templates %}
					<li data-id="{{ template.id }}">
					{% if template.template_short_name == 'index' %}
						<a href="#"><em>{{ template.template_short_name }}</em></a>
					{% else %}
						<a href="#">{{ template.template_short_name }}</a>
					{% endif %}
					</li>
				{% endfor %}
				</ul>
			</li>
			{% endfor %}
		</ul>
	</div>
	<script id="template-list-item-template" type="text/html">
		<li data-id="<%= id %>"><a href="#"><%= template_short_name %></a></li>
	</script>
		
	<div id="template-view">
		<ul class="nav nav-tabs" id="tabs">
		  <li class="active"><a href="#editor-pane">Editor</a></li>
		  <li><a href="#settings-pane">Settings</a></li>
		</ul>
		<div class="tab-content">
			<div id="editor-pane" class="tab-pane active">
				<pre id="editor"></pre>
			</div>
			<div id="settings-pane" class="tab-pane">
				<form id="settings-form">
					{% for field in form %}
						{% if not field.is_hidden %}
						<div class="accordion-group">
								<div class="field_label_holder" data-toggle="collapse" data-target="#form_fieldholder_{{ forloop.counter }}">
									{% if field.field.required %}<span class="required">* </span>{% endif %}{{ field.label_tag }}
									{% if field.errors %}<div class="alert alert-error">{{ field.errors }}</div>{% endif %}
								</div>
								<div id="form_fieldholder_{{ forloop.counter }}" class="collapse control-group field_holder {% if field.errors %}error{% endif %} {% if not field.field.field_collapsed_by_default %}in{% endif %}">
									{{ field }}
									{% if field.help_text %}<p class="help_text">{{ field.help_text }}</p>{% endif %}
								</div>
						</div>
						{% else %}
							{{ field }}
						{% endif %}
					{% endfor %}
				</form>
			</div>
		</div>
	</div>
	<script id="form-error-template" type="text/html">
		<div class="alert alert-error"><ul class="errorlist"><%= errors %></ul></div>
	</script>
		
{% endblock %}

{% block post_content %}
<div class="modal hide" id="create-template-modal">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal">×</button>
		<h3>Create Template</h3>
	</div>
	<div class="modal-body">
		<form>
			<div class="field-holder">
				{{ new_template_form.template_short_name.label_tag }}
				{{ new_template_form.template_short_name }}
				<p class="help_text">{{ new_template_form.template_short_name.help_text }}</p>
			</div>
			<div class="field-holder">
				{{ new_template_form.template_content_type.label_tag }}
				{{ new_template_form.template_content_type }}
				<p class="help_text">{{ new_template_form.template_content_type.help_text }}</p>
			</div>
			<div class="field-holder">
				{{ new_template_form.template_is_private.label_tag }}
				{{ new_template_form.template_is_private }}
				<p class="help_text">{{ new_template_form.template_is_private.help_text }}</p>
			</div>
			{{ new_template_form.templategroup }}
		</form>
	</div>
	<div class="modal-footer">
		<a href="#" class="btn" data-dismiss="modal">Cancel</a>
		<a href="#" class="btn btn-primary" id="create-template-button">Create</a>
	</div>
</div>

<div class="modal hide" id="delete-template-modal">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal">×</button>
		<h3>Confirm Delete</h3>
	</div>
	<div class="modal-body">
		<p>Are you sure you want to <b>permanently</b> delete this template?</p>
	</div>
	<div class="modal-footer">
		<a href="#" class="btn" data-dismiss="modal">Cancel</a>
		<a href="#" class="btn btn-danger" id="confirm-delete-template-button">Delete</a>
	</div>
</div>
{% endblock %}

{% block javascript %}
	<script src="{{ STATIC_URL }}thunderchild/js/ace/ace.js"></script>
	<script src="{{ STATIC_URL }}thunderchild/js/ace/theme-twilight.js"></script>
	<script src="{{ STATIC_URL }}thunderchild/js/ace/mode-html.js"></script>
	{% if debug %}
		<script src="{{ STATIC_URL }}thunderchild/js_src/templates.js"></script>
	{% else %}
		<script src="{{ STATIC_URL }}thunderchild/js/templates-min.js"></script>
	{% endif %}
{% endblock %}
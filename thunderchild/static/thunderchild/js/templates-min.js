(function(){var d,h,g,f,c,e,a;var b=function(i,j){return function(){return i.apply(j,arguments)}};d=Backbone.Model.extend({selectedGroupItem:null,selectedTemplateItem:null});h=Backbone.View.extend({initialize:function(){this.templatePane=this.options.templatePane;this.id=this.$el.attr("data-id");this.groupName=this.$el.attr("data-group");this.editButton=this.$el.find(".edit-button");return this.icon=this.$el.find(".icon-folder-close")},events:{click:"clickHandler"},clickHandler:function(j){var i;this.select();j.stopPropagation();i=j.target;if($(j.target).attr("href")==="#"){return j.preventDefault()}},select:function(){this.$el.addClass("selected");this.model.set({selectedGroupItem:this});this.editButton.show();if(this.groupName!=="root"){return this.icon.addClass("icon-folder-open")}},deselect:function(){this.$el.removeClass("selected");this.editButton.hide();if(this.groupName!=="root"){return this.icon.removeClass("icon-folder-open")}}});f=Backbone.View.extend({el:"#group_pane",initialize:function(){this.groups=[];this.$el.find("ul li").each(b(function(k,l){var j;j=new h({el:l,model:this.model});return this.groups.push(j)},this));return this.model.on("change:selectedGroupItem",this.selectedGroupItemChangeHandler,this)},selectedGroupItemChangeHandler:function(){return _.each(this.groups,b(function(i){if(i!==this.model.get("selectedGroupItem")){return i.deselect()}},this))},selectItem:function(n){var k,m,j,l,i;l=this.groups;i=[];for(m=0,j=l.length;m<j;m++){k=l[m];i.push(k.groupName===n?k.select():void 0)}return i}});c=Backbone.View.extend({initialize:function(){this.id=this.$el.attr("data-id");this.groupName=this.$el.attr("data-group");this.editButton=this.$el.find(".edit-button");return this.editButton.hide()},events:{click:"clickHandler"},clickHandler:function(i){this.select();this.model.set({selectedTemplateItem:this});i.stopPropagation();if($(i.target).attr("href")==="#"){return i.preventDefault()}},show:function(){return this.$el.show()},hide:function(){return this.$el.hide()},select:function(){this.$el.addClass("selected");return this.editButton.show()},deselect:function(){this.$el.removeClass("selected");return this.editButton.hide()}});a=Backbone.View.extend({el:"#template_pane",initialize:function(){this.templates=[];this.$el.find("ul li").each(b(function(j,k){return this.templates.push(new c({el:k,model:this.model}))},this));this.model.on("change:selectedGroupItem",this.selectedGroupItemChangeHandler,this);return this.model.on("change:selectedTemplateItem",this.selectedTemplateItemChangeHandler,this)},selectedGroupItemChangeHandler:function(){var i;i=this.model.get("selectedGroupItem");this.model.set({selectedTemplateItem:null});return this.filter(i.groupName)},selectedTemplateItemChangeHandler:function(){var i;i=this.model.get("selectedTemplateItem");return _.each(this.templates,function(j){if(j!==i){return j.deselect()}})},filter:function(k){var j,i;i=_.filter(this.templates,function(l){return l.groupName===k});j=_.reject(this.templates,function(l){return l.groupName===k});_.each(i,function(l){return l.show()});_.each(j,function(l){l.hide();return l.deselect()});return i[0].select()}});e=Backbone.View.extend({el:"#template_pane_controls",initialize:function(){this.createTemplateButton=$("#create_template_button");return this.model.on("change:selectedGroupItem",this.selectedGroupItemChangeHandler,this)},selectedGroupItemChangeHandler:function(){var i,j;i=this.model.get("selectedGroupItem");j=_.template("templates/group/<%= group_id %>/create",{group_id:i.id});return this.createTemplateButton.attr("href",j)}});g=Backbone.View.extend({el:"#group_pane_controls"});$(function(){var i,j,l,k;i=new d();l=new a({model:i});k=new e({model:i});j=new f({model:i});return j.selectItem("root")})}).call(this);
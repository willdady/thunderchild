(function(){var a;a=0;window.AppModel=Backbone.Model.extend({hideMediaChooser:function(){this.unset("uid");return this.trigger("hideMediaChooser")},showMediaChooser:function(b){this.set("uid",b);return this.trigger("showMediaChooser")},assetSelectionCallback:function(b){return this.trigger("assetSelected",b)}});window.MediaChooserWidgetView=Backbone.View.extend({initialize:function(){this.chooseFileButton=$('<a href="#" class="btn choose-file-button">Choose file</a>').click(_.bind(this.chooseFileButtonClickHandler,this));this.$el.parent().prepend(this.chooseFileButton);this.$el.hide();this.uid=a;a++;return this.model.on("assetSelected",this.assetSelectedHandler,this)},chooseFileButtonClickHandler:function(b){this.model.showMediaChooser(this.uid);return b.preventDefault()},assetSelectedHandler:function(c){var b,d;if(this.model.get("uid")!==this.uid){return}this.$el.val(c.id);d=_.template($("#mediaAssetThumbnailTemplate").text());b=d({thumbnail_url:c.thumbnail_url,filename:c.filename});this.existingThumbnail=this.$el.parent().find(".media-asset-thumbnail");if(this.existingThumbnail.length>0){this.existingThumbnail.replaceWith(b)}else{this.$el.parent().prepend(b)}return this.model.hideMediaChooser()}});window.MediaChooserModalView=Backbone.View.extend({initialize:function(){this.$el.modal().modal("hide");this.model.on("showMediaChooser",this.show,this);return this.model.on("hideMediaChooser",this.hide,this)},show:function(){return this.$el.modal("show")},hide:function(){return this.$el.modal("hide")}})}).call(this);